<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reviewer Summary ‚Äì FY2025</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .container { max-width: 960px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
    h1, h2 { margin-top: 0; }
    .header { border-bottom: 2px solid #ddd; padding-bottom: 12px; margin-bottom: 20px; }
    .meta { color: #555; }
    .section { border: 1px solid #e6e6e6; margin-bottom: 18px; padding: 16px; border-radius: 6px; background: #fafafa; }
    .flag { margin: 12px 0 16px; padding: 12px; border-left: 5px solid #ff9800; background: #fff7e6; border-radius: 4px; }
    .flag h3 { margin: 0 0 6px; }
    .carried { border-left: 5px solid #1976d2; background: #f1f7ff; }
    .icon { font-size: 18px; margin-right: 6px; }
    .controls { margin-top: 8px; }
    button { margin: 4px; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; }
    .btn-approve { background: #4caf50; color: white; }
    .btn-edit { background: #2196f3; color: white; }
    .btn-doc { background: #795548; color: white; }
    .btn-link { background: #9c27b0; color: white; }
    .btn-lock { background: #673ab7; color: white; }
    details { margin-top: 6px; background: #fff; border: 1px solid #e6e6e6; border-radius: 4px; padding: 8px; }
    details summary { cursor: pointer; font-weight: bold; }
    .letter { background: #fff; border: 1px solid #ddd; padding: 20px; border-radius: 6px; line-height: 1.6; }
    .issue-block { margin: 18px 0; padding: 12px; border-left: 4px solid #b0b8c4; background: #f8f9fb; border-radius: 4px; }
    .issue-block.carried { border-left: 4px solid #93a6d1; background: #f4f6fb; }
    .actions { text-align: center; margin-top: 16px; }
    /* New unified card header + status chips */
    .card-header { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
    .card-title { font-weight: bold; }
    .status { padding: 2px 8px; border-radius: 999px; font-size: 12px; color: #333; background: #eee; border: 1px solid #ddd; }
    .status-draft { background: #fff; }
    .status-approved { background: #e7f7ea; color: #1b5e20; border-color: #c8e6c9; }
    .status-carried { background: #e7f0fb; color: #0d47a1; border-color: #bbdefb; }
    .status-snoozed { background: #fff3cd; color: #795548; border-color: #ffe08a; }
    .flag-summary { margin: 6px 0 10px; color: #333; }
    .field-label { font-weight: bold; display: block; margin: 10px 0 6px; }
    textarea { width: 100%; min-height: 72px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; resize: vertical; }
    .action-row { display: flex; flex-wrap: wrap; gap: 8px 14px; align-items: center; margin-top: 10px; }
    .toggle { display: inline-flex; align-items: center; gap: 6px; }
    .snoozed { opacity: 0.6; }
    .audit { margin-top: 8px; font-size: 12px; color: #555; }
    .audit ul { margin: 6px 0 0 18px; }
  </style>
</head>
<body>
  <div class="container">
    <!-- HEADER -->
    <div class="header">
      <h1>Reviewer Summary ‚Äì FY2025</h1>
      <div class="meta">
        <strong>Client:</strong> John Smith &nbsp;|&nbsp;
        <strong>Preparer:</strong> A. Brown &nbsp;|&nbsp;
        <strong>Reviewer:</strong> T. Lee &nbsp;|&nbsp;
        <strong>Status:</strong> Draft &nbsp;|&nbsp;
        <strong>Checklist:</strong> 9/11 complete
      </div>
    </div>

    <!-- SECTION 1: KEY ISSUES (Unified Cards) -->
    <div class="section" id="section-cards">
      <h2>üîπ Section 1 ‚Äì Review Checklist (Reviewer‚Äôs view)</h2>

      <!-- Card: CGT Disposal Carried Forward -->
      <div class="flag card carried" data-key="cgt-cf">
        <div class="card-header">
          <div class="card-title"><span class="icon">‚ö†Ô∏è</span>CGT Disposal Carried Forward</div>
          <span class="status status-carried" data-status>Carried forward</span>
        </div>
        <p class="flag-summary">Contract date July 2025 ‚Üí outside FY2025. Excluded and carried forward.</p>
        <p><strong>‚úÖ</strong> Attach docs ‚Üí auto carry to FY2026.</p>

        <label class="field-label" for="cgtcf-note">AI draft ‚Äì Reviewer note</label>
        <textarea id="cgtcf-note" class="reviewer-note">CGT disposal contract July 2025 ‚Üí falls in FY2026. Event auto-carried forward.</textarea>

        <label class="field-label" for="cgtcf-client">AI draft ‚Äì Client copy</label>
        <textarea id="cgtcf-client" class="client-copy">Your CGT disposal contract occurred in July 2025, so the event falls into FY2026. It is excluded from this year and will be carried forward.</textarea>

        <details>
          <summary>AI-suggested resources</summary>
          <ul>
            <li><label><input type="checkbox" class="res-choice" value="ATO: CGT events ‚Äì contract vs settlement"> ATO: CGT events ‚Äì contract vs settlement</label></li>
            <li><label><input type="checkbox" class="res-choice" value="Internal: CGT timing explainer"> Internal: CGT timing explainer</label></li>
          </ul>
          <button class="btn-link" type="button">Add Resource</button>
        </details>

        <details>
          <summary>Documents</summary>
          <ul>
            <li>Contract.pdf</li>
            <li>Settlement.pdf</li>
          </ul>
          <button class="btn-doc" type="button">Attach / Link Document</button>
        </details>

        <details>
          <summary>Deep links ‚Äì Tax return</summary>
          <div>
            <button class="btn-link" type="button">Open Tax return</button>
            <button class="btn-link" type="button">Open Item 18 ‚Äì Capital gains</button>
            <button class="btn-link" type="button">Open Capital gains schedule</button>
            <button class="btn-link" type="button">Open Capital gains worksheet</button>
          </div>
        </details>

        <div class="action-row">
          <button class="btn-approve" type="button" data-action="approve">Approve</button>
          <label class="toggle"><input type="checkbox" data-action="add-to-letter"> Add to client letter</label>
          <label class="toggle"><input type="checkbox" data-action="carry-forward" checked> Carry forward to FY2026</label>
          <button class="btn-edit" type="button" data-action="snooze">Snooze / Not applicable</button>
          <button class="btn-edit" type="button" data-action="comment">Add comment</button>
        </div>
        <div class="audit" hidden>
          <strong>Audit trail</strong>
          <ul></ul>
        </div>
      </div>

      <!-- Card: PAYG Instalments Trigger -->
      <div class="flag card" data-key="payg">
        <div class="card-header">
          <div class="card-title"><span class="icon">‚ö†Ô∏è</span>PAYG Instalments Trigger</div>
          <span class="status status-draft" data-status>Draft</span>
        </div>
        <p class="flag-summary">New sole trader business income has no withholding. Likely PAYG for FY2026.</p>
        <p><strong>‚úÖ</strong> Consider cashflow advisory and Small business income tax offset.</p>

        <label class="field-label" for="payg-note">AI draft ‚Äì Reviewer note</label>
        <textarea id="payg-note" class="reviewer-note">Sole trader income has no withholding ‚Üí PAYG instalments expected for FY2026. Link to tax payable once return finalised. Confirm eligibility for small business income tax offset.</textarea>

        <label class="field-label" for="payg-client">AI draft ‚Äì Client copy</label>
        <textarea id="payg-client" class="client-copy">You have new sole trader business income without tax withheld, so you may begin PAYG instalments in FY2026. Once the return is completed, we will confirm your tax payable and likely PAYG amounts. You may also be eligible for the small business income tax offset. We can help plan for cashflow.</textarea>

        <details>
          <summary>AI-suggested resources</summary>
          <ul>
            <li><label><input type="checkbox" class="res-choice" value="ATO: PAYG instalments"> ATO: PAYG instalments</label></li>
            <li><label><input type="checkbox" class="res-choice" value="Internal: Cashflow advisory checklist"> Internal: Cashflow advisory checklist</label></li>
          </ul>
          <button class="btn-link" type="button">Add Resource</button>
        </details>

        <details>
          <summary>Documents</summary>
          <ul>
            <li>PAYG_Estimator.pdf</li>
          </ul>
          <button class="btn-doc" type="button">Attach / Link Document</button>
        </details>

        <details>
          <summary>Deep links ‚Äì Tax return</summary>
          <div>
            <button class="btn-link" type="button">Open Tax return</button>
            <button class="btn-link" type="button">Open Item P9 ‚Äì Business income (non‚Äëprimary production)</button>
            <button class="btn-link" type="button">Open Item 15 ‚Äì Small business income tax offset</button>
          </div>
        </details>

        <div class="action-row">
          <button class="btn-approve" type="button" data-action="approve">Approve</button>
          <label class="toggle"><input type="checkbox" data-action="add-to-letter"> Add to client letter</label>
          <label class="toggle"><input type="checkbox" data-action="carry-forward"> Carry forward to FY2026</label>
          <button class="btn-edit" type="button" data-action="snooze">Snooze / Not applicable</button>
          <button class="btn-edit" type="button" data-action="comment">Add comment</button>
        </div>
        <div class="audit" hidden>
          <strong>Audit trail</strong>
          <ul></ul>
        </div>
      </div>

      <!-- Card: Trust Distribution - Variance -->
      <div class="flag card" data-key="trust">
        <div class="card-header">
          <div class="card-title"><span class="icon">‚ö†Ô∏è</span>Trust Distribution - Variance</div>
          <span class="status status-draft" data-status>Draft</span>
        </div>
        <p class="flag-summary">Distribution in Kerry's return differs from David's Family Trust ledger.</p>
        <p><strong>‚úÖ</strong> Reviewer follow-up: confirm beneficiary share and reconcile with trust accounts.</p>

        <label class="field-label" for="trust-note">AI draft ‚Äì Reviewer note</label>
        <textarea id="trust-note" class="reviewer-note">Variance detected between Kerry's return and David's Family Trust distribution ledger. Confirm allocation and reconcile to trust accounts; amend return or request ledger correction as required.</textarea>

        <!-- Reviewer-only: no client copy required -->

        <details>
          <summary>AI-suggested resources</summary>
          <ul>
            <li><label><input type="checkbox" class="res-choice" value="ATO: Trust distributions"> ATO: Trust distributions</label></li>
          </ul>
          <button class="btn-link" type="button">Add Resource</button>
        </details>

        <details>
          <summary>Documents</summary>
          <ul>
            <li>David's Family Trust ‚Äì Distribution Statement 2025.pdf</li>
          </ul>
          <button class="btn-doc" type="button">Attach / Link Document</button>
        </details>

        <details>
          <summary>Deep links ‚Äì Tax return & ledger</summary>
          <div>
            <button class="btn-link" type="button">Open Tax return</button>
            <button class="btn-link" type="button">Open Item 13 ‚Äì Partnerships and trusts (Distributions received)</button>
            <button class="btn-link" type="button">Open Client Accounting ‚Äì Trust ledger</button>
          </div>
        </details>

        <div class="action-row">
          <button class="btn-approve" type="button" data-action="approve">Approve</button>
          <!-- Reviewer-only: no client letter toggle -->
          <label class="toggle"><input type="checkbox" data-action="carry-forward"> Carry forward to FY2026</label>
          <button class="btn-edit" type="button" data-action="snooze">Snooze / Not applicable</button>
          <button class="btn-edit" type="button" data-action="comment">Add comment</button>
        </div>
        <div class="audit" hidden>
          <strong>Audit trail</strong>
          <ul></ul>
        </div>
      </div>

      <!-- Card: Rental Property Debt Risk removed per request -->

      <!-- Card: Capital losses carried forward -->
      <div class="flag card" data-key="cap-losses">
        <div class="card-header">
          <div class="card-title"><span class="icon">‚ö†Ô∏è</span>Capital losses carried forward</div>
          <span class="status status-draft" data-status>Draft</span>
        </div>
        <p class="flag-summary">$42,000 carried forward. Ensure correct application this year.</p>
        <p><strong>‚úÖ</strong> Flag planning for future disposals.</p>

        <label class="field-label" for="caploss-note">AI draft ‚Äì Reviewer note</label>
        <textarea id="caploss-note" class="reviewer-note">$42k capital losses carried forward. Check utilisation + planning.</textarea>

        <label class="field-label" for="caploss-client">AI draft ‚Äì Client copy</label>
        <textarea id="caploss-client" class="client-copy">You have $42,000 of capital losses carried forward. We will ensure correct application this year and use this as a planning opportunity to time future disposals tax‚Äëeffectively.</textarea>

        <details>
          <summary>AI-suggested resources</summary>
          <ul>
            <li><label><input type="checkbox" class="res-choice" value="ATO: Capital losses"> ATO: Capital losses</label></li>
            <li><label><input type="checkbox" class="res-choice" value="Internal: CGT planning notes"> Internal: CGT planning notes</label></li>
          </ul>
          <button class="btn-link" type="button">Add Resource</button>
        </details>

        <details>
          <summary>Documents</summary>
          <ul>
            <li>Capital_Losses_Schedule.pdf</li>
          </ul>
          <button class="btn-doc" type="button">Attach / Link Document</button>
        </details>

        <details>
          <summary>Deep links ‚Äì Tax return</summary>
          <div>
            <button class="btn-link" type="button">Open Tax return</button>
            <button class="btn-link" type="button">Open Item 18 ‚Äì Capital gains</button>
            <button class="btn-link" type="button">Open Capital gains losses</button>
            <button class="btn-link" type="button">Open Capital gains worksheet</button>
          </div>
        </details>

        <div class="action-row">
          <button class="btn-approve" type="button" data-action="approve">Approve</button>
          <label class="toggle"><input type="checkbox" data-action="add-to-letter"> Add to client letter</label>
          <label class="toggle"><input type="checkbox" data-action="carry-forward"> Carry forward to FY2026</label>
          <button class="btn-edit" type="button" data-action="snooze">Snooze / Not applicable</button>
          <button class="btn-edit" type="button" data-action="comment">Add comment</button>
        </div>
        <div class="audit" hidden>
          <strong>Audit trail</strong>
          <ul></ul>
        </div>
      </div>

      <!-- Card: AirBnb income risk -->
      <div class="flag card" data-key="gig-income">
        <div class="card-header">
          <div class="card-title"><span class="icon">‚ö†Ô∏è</span>AirBnb income risk</div>
          <span class="status status-draft" data-status>Draft</span>
        </div>
        <p class="flag-summary">Uber/Airbnb detected. ATO targeting digital platform reporting.</p>
        <p><strong>‚úÖ</strong> Confirm full disclosure and advise on records.</p>

        <label class="field-label" for="gig-note">AI draft ‚Äì Reviewer note</label>
        <textarea id="gig-note" class="reviewer-note">Platform income (Uber/Airbnb) detected. Ensure full disclosure.</textarea>

        <label class="field-label" for="gig-client">AI draft ‚Äì Client copy</label>
        <textarea id="gig-client" class="client-copy">We detected platform income (Uber/Airbnb). The ATO is targeting digital platform reporting. Please ensure full disclosure and maintain records.</textarea>

        <details>
          <summary>AI-suggested resources</summary>
          <ul>
            <li><label><input type="checkbox" class="res-choice" value="ATO: Sharing economy and tax"> ATO: Sharing economy and tax</label></li>
            <li><label><input type="checkbox" class="res-choice" value="Internal: Gig income disclosure checklist"> Internal: Gig income disclosure checklist</label></li>
          </ul>
          <button class="btn-link" type="button">Add Resource</button>
        </details>

        <details>
          <summary>Documents</summary>
          <ul>
            <li>Platform_Statements_2025.pdf</li>
          </ul>
          <button class="btn-doc" type="button">Attach / Link Document</button>
        </details>

        <details>
          <summary>Deep links</summary>
          <button class="btn-link" type="button">Open related schedule / worksheet</button>
        </details>

        <div class="action-row">
          <button class="btn-approve" type="button" data-action="approve">Approve</button>
          <label class="toggle"><input type="checkbox" data-action="add-to-letter"> Add to client letter</label>
          <label class="toggle"><input type="checkbox" data-action="carry-forward"> Carry forward to FY2026</label>
          <button class="btn-edit" type="button" data-action="snooze">Snooze / Not applicable</button>
          <button class="btn-edit" type="button" data-action="comment">Add comment</button>
        </div>
        <div class="audit" hidden>
          <strong>Audit trail</strong>
          <ul></ul>
        </div>
      </div>
    </div>

    <!-- SECTION 2 removed: merged into Section 1 cards -->

    <!-- SECTION 3: CLIENT COMMUNICATION -->
    <div class="section">
      <h2>Section 3 ‚Äì Client Communication Draft</h2>
      <div class="letter">
        <p>Dear John,</p>

        <p>We thank you for allowing us the opportunity to assist you with your taxation needs. 
        We are pleased to enclose your Income Tax Return for the year ended 30 June 2025.</p>

        <p>Please review the Income Tax Return marked ‚ÄòClient Copy‚Äô attached to this letter. 
        Please note that the income tax calculation is an estimate only, as PAYG Instalments 
        and other disclosures in the return are dependent on the Australian Taxation Office (ATO) 
        cross-referencing these amounts.</p>

        <!-- Dynamic flagged items selected from Section 1 cards will render here -->
        <div id="letter-issues"></div>

        <!-- Continue cover letter -->
        <p>Once you are satisfied that the Income Tax Return is correct, please sign and date Parts A 
        and B of the attached Electronic Lodgement Declaration, as well as sign and date the 
        Taxpayer‚Äôs Declaration.</p>

        <p>Upon signing these Declarations, please send them to us so we can lodge your return 
        electronically with the ATO. You should receive your Notice of Assessment within 
        14 days of lodgement of the return. Please note that we have redacted your Tax File Number 
        and bank account details to protect your identity for confidentiality reasons.</p>

        <p>The Taxpayer‚Äôs Declaration that you are signing confirms that the information you have 
        provided us for the preparation of your income tax return is true and correct and that you 
        are authorising us as your registered tax agent to lodge the return on your behalf.</p>

        <p>Please note that you must also retain all records relating to the compilation of the 
        income tax return for five years (in most instances) after the Notice of Assessment 
        is issued. This will include receipts for expenses, logbooks, and other records. If you 
        do not have these records, or have any questions about the necessary records, 
        please contact us.</p>

        <p>We estimate that upon assessment you will be [required to pay income tax OR receive an 
        income tax refund] of $xxx.xx. This amount has been calculated based on a taxable income 
        of $xx,xxx.xx.<br>
        [IF RELEVANT] Your Reportable Fringe Benefits figure for the year was $xx,xxx.xx.<br>
        [IF RELEVANT] The amount of Higher Education Loan Program (HELP) repaid was $xx,xxx.xx.</p>

        <p>We also enclose our account for the preparation and lodgement of your Income Tax Return.</p>

        <p>Finally, we thank you for your support and the opportunity to be of service to you.
        If you have further queries on any details contained in this letter or on any other matter, 
        please feel free to contact us on [insert telephone number].</p>

        <p>Yours faithfully,<br>[Insert Name and Title]</p>
      </div>
    </div>

    <!-- SECTION 4: ACTIONS -->
    <div class="section actions">
      <button class="btn-approve">Approve All Items</button>
      <button class="btn-edit">Edit Client Letter</button>
      <button class="btn-lock">Lock & Publish</button>
    </div>
  <script>
    (function() {
      function nowIso() {
        try { return new Date().toISOString(); } catch(e) { return '' }
      }

      function setStatus(card, status) {
        const chip = card.querySelector('[data-status]');
        if (!chip) return;
        chip.classList.remove('status-draft','status-approved','status-carried','status-snoozed');
        if (status === 'approved') {
          chip.textContent = 'Approved';
          chip.classList.add('status-approved');
          card.classList.remove('snoozed');
        } else if (status === 'carried') {
          chip.textContent = 'Carried forward';
          chip.classList.add('status-carried');
          card.classList.remove('snoozed');
        } else if (status === 'snoozed') {
          chip.textContent = 'Snoozed';
          chip.classList.add('status-snoozed');
          card.classList.add('snoozed');
        } else {
          chip.textContent = 'Draft';
          chip.classList.add('status-draft');
          card.classList.remove('snoozed');
        }
        chip.setAttribute('data-status-value', status);
      }

      function upsertLetterBlock(key, title, icon, text, carried) {
        const container = document.getElementById('letter-issues');
        if (!container) return;
        let block = container.querySelector('[data-letter-key="'+key+'"]');
        if (!text || text.trim() === '') {
          if (block) block.remove();
          return;
        }
        if (!block) {
          block = document.createElement('div');
          block.className = 'issue-block'+(carried ? ' carried' : '');
          block.setAttribute('data-letter-key', key);
          block.innerHTML = '<h3><span class="icon">'+icon+'</span>'+title+'</h3><p class="copy"></p>';
          container.appendChild(block);
        } else {
          block.className = 'issue-block'+(carried ? ' carried' : '');
          const h3 = block.querySelector('h3');
          if (h3) h3.innerHTML = '<span class="icon">'+icon+'</span>'+title;
        }
        const p = block.querySelector('.copy');
        if (p) p.textContent = text;
      }

      function removeLetterBlock(key) {
        const container = document.getElementById('letter-issues');
        const block = container && container.querySelector('[data-letter-key="'+key+'"]');
        if (block) block.remove();
      }

      function initCard(card) {
        const key = card.getAttribute('data-key');
        const title = card.querySelector('.card-title')?.textContent?.trim() || '';
        const icon = card.querySelector('.card-title .icon')?.textContent || '';
        const clientCopy = card.querySelector('.client-copy');

        // Initial carried status
        const carriedChecked = card.querySelector('[data-action="carry-forward"]')?.checked;
        if (carriedChecked) setStatus(card, 'carried');

        const approveBtn = card.querySelector('[data-action="approve"]');
        if (approveBtn) approveBtn.addEventListener('click', function() {
          setStatus(card, 'approved');
          const audit = card.querySelector('.audit');
          if (audit) {
            audit.hidden = false;
            const ul = audit.querySelector('ul');
            const li = document.createElement('li');
            li.textContent = nowIso()+': Approved by reviewer';
            ul.appendChild(li);
          }
        });

        const carryTgl = card.querySelector('[data-action="carry-forward"]');
        if (carryTgl) carryTgl.addEventListener('change', function() {
          setStatus(card, this.checked ? 'carried' : 'draft');
          const addToLetter = card.querySelector('[data-action="add-to-letter"]');
          if (addToLetter && addToLetter.checked) {
            upsertLetterBlock(key, title, icon, clientCopy?.value || '', this.checked);
          }
        });

        const snoozeBtn = card.querySelector('[data-action="snooze"]');
        if (snoozeBtn) snoozeBtn.addEventListener('click', function() {
          const chipVal = card.querySelector('[data-status]')?.getAttribute('data-status-value');
          const newState = chipVal === 'snoozed' ? 'draft' : 'snoozed';
          setStatus(card, newState);
          const audit = card.querySelector('.audit');
          if (audit) {
            audit.hidden = false;
            const ul = audit.querySelector('ul');
            const li = document.createElement('li');
            li.textContent = nowIso()+': '+(newState==='snoozed'?'Snoozed/Not applicable':'Unsnoozed');
            ul.appendChild(li);
          }
        });

        const commentBtn = card.querySelector('[data-action="comment"]');
        if (commentBtn) commentBtn.addEventListener('click', function() {
          const note = prompt('Add comment (will appear in audit trail):');
          if (!note) return;
          const audit = card.querySelector('.audit');
          if (audit) {
            audit.hidden = false;
            const ul = audit.querySelector('ul');
            const li = document.createElement('li');
            li.textContent = nowIso()+': '+note;
            ul.appendChild(li);
          }
        });

        const addToLetter = card.querySelector('[data-action="add-to-letter"]');
        if (addToLetter) addToLetter.addEventListener('change', function() {
          if (this.checked) {
            upsertLetterBlock(key, title, icon, clientCopy?.value || '', card.querySelector('[data-action="carry-forward"]')?.checked);
          } else {
            removeLetterBlock(key);
          }
        });

        if (clientCopy) clientCopy.addEventListener('input', function() {
          const checked = card.querySelector('[data-action="add-to-letter"]')?.checked;
          if (checked) {
            upsertLetterBlock(key, title, icon, clientCopy.value, card.querySelector('[data-action="carry-forward"]')?.checked);
          }
        });
      }

      document.querySelectorAll('.flag.card').forEach(initCard);
    })();
  </script>
  </div>
</body>
</html>
